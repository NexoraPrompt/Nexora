<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Optimiza tu Prompt</title>

  <!-- Logo de pesta√±a (favicon) -->
  <link rel="icon" type="image/png" href="https://i.imgur.com/efDFIrP.png">

  <!-- Open Graph / Redes sociales -->
  <meta property="og:title" content="Optimiza tu Prompt">
  <meta property="og:image" content="https://i.imgur.com/efDFIrP.png">
  <meta property="og:type" content="website">
  <meta property="og:description" content="Mejora tus prompts de forma r√°pida con audio o texto.">
  <meta property="og:url" content="">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Optimiza tu Prompt">
  <meta name="twitter:image" content="https://i.imgur.com/efDFIrP.png">
  <meta name="twitter:description" content="Mejora tus prompts f√°cilmente.">

  <!-- Fuente -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #667eea, #764ba2);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .logo {
      display: block;
      margin: 2rem auto 1rem;
      max-width: 160px;
    }

    .container {
      flex: 1;
      width: 90%;
      max-width: 800px;
      margin: 1rem auto 2rem;
      background: linear-gradient(135deg, #e3e9f7, #e7e4f2);
      padding: 2rem;
      border-radius: 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }

    h1 {
      text-align: center;
      color: #3c366b;
      font-weight: 700;
      font-size: 1.8rem;
    }

    .content-group {
      width: 100%;
    }

    .button-row {
      display: flex;
      gap: 1rem;
      margin: 1rem 0;
    }

    .button-row button {
      font-family: 'Orbitron', sans-serif;
      flex: 1;
      padding: 12px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 10px;
      background: linear-gradient(to right, #667eea, #764ba2);
      color: white;
      font-weight: 600;
      transition: background 0.3s;
    }

    .button-row button:hover {
      background: linear-gradient(to right, #764ba2, #667eea);
    }

    textarea {
      width: 100%;
      height: 120px;
      margin-bottom: 1rem;
      padding: 12px;
      font-size: 15px;
      border-radius: 10px;
      border: 1px solid #ccc;
      resize: vertical;
      background-color: #f9fdfb;
      font-family: 'Orbitron', sans-serif;
      box-sizing: border-box;
    }

    h2 {
      margin-top: 1.5rem;
      color: #3c366b;
      font-weight: 600;
    }

    #durationDisplay {
      text-align: center;
      font-size: 1.2rem;
      color: #3c366b;
      margin-top: 0.5rem;
    }

    footer {
      background-color: #2d3748;
      color: white;
      text-align: center;
      padding: 1rem;
      font-size: 14px;
    }

    footer a {
      color: #90cdf4;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    /* Media Queries para m√≥vil */
    @media (max-width: 480px) {
      .button-row {
        flex-direction: column;
      }

      .button-row button {
        width: 100%;
      }

      h1 {
        font-size: 1.6rem;
      }

      h2 {
        font-size: 1.1rem;
      }

      textarea {
        font-size: 15px;
        min-height: 110px;
        padding: 12px 14px;
      }

      .container {
        padding: 1rem 1rem 1.5rem;
        border-radius: 16px;
      }

      #durationDisplay {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <img src="https://i.imgur.com/Au9XUJn.png" alt="Logo" class="logo">

  <div class="container">
    <h1>Optimiza tu Prompt</h1>
    <div class="content-group">
      <div class="button-row">
        <button id="recordButton">üé§ Grabar Audio</button>
        <button id="optimizeButton">‚ú® Optimizar Prompt</button>
      </div>
      <div id="durationDisplay">‚è±Ô∏è Duraci√≥n: 0s</div>
      <textarea id="inputText" placeholder="Aqu√≠ aparecer√° la transcripci√≥n o escribe tu texto sencillo..."></textarea>
      <h2>üîß Prompt optimizado:</h2>
      <textarea id="optimizedPrompt" readonly placeholder="Aqu√≠ se mostrar√° el prompt mejorado..."></textarea>
    </div>
  </div>

  <!-- Bot√≥n fuera del container -->
  <div style="text-align: center; margin-bottom: 2rem;">
    <button onclick="window.location.href='index.html'" style="
      font-family: 'Orbitron', sans-serif;
      padding: 12px 24px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 12px;
      background: linear-gradient(to right, #667eea, #764ba2);
      color: white;
      font-weight: 600;
      transition: background 0.3s;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    " onmouseover="this.style.background='linear-gradient(to right, #764ba2, #667eea)'" 
       onmouseout="this.style.background='linear-gradient(to right, #667eea, #764ba2)'">
      ‚¨ÖÔ∏è Volver    </button>
  </div>

  <footer>
    ¬© 2025 Nexora. Todos los derechos reservados. | <a href="#">Pol√≠tica de privacidad</a> | <a href="#">T√©rminos y condiciones</a>
  </footer>
</body>
</html>

  <script>
  const recordButton = document.getElementById("recordButton");
  const optimizeButton = document.getElementById("optimizeButton");
  const inputText = document.getElementById("inputText");
  const optimizedPrompt = document.getElementById("optimizedPrompt");
  const durationDisplay = document.getElementById("durationDisplay");

  let recognition;
  let isRecording = false;
  let startTime = 0;
  let durationInterval;

  if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    recognition = new SpeechRecognition();
    recognition.lang = 'es-ES';
    recognition.continuous = true;
    recognition.interimResults = false;

    recognition.onresult = (event) => {
      let transcript = "";
      for (let i = event.resultIndex; i < event.results.length; ++i) {
        transcript += event.results[i][0].transcript + " ";
      }
      inputText.value += transcript.trim() + " ";
      optimizePrompt(inputText.value);
    };

    recognition.onerror = (event) => console.error("Error de reconocimiento:", event.error);
    recognition.onend = () => { if (isRecording) recognition.start(); };

    function startRecording() {
      isRecording = true;
      inputText.value = "";
      optimizedPrompt.value = "";
      recordButton.textContent = "‚èπÔ∏è Detener";
      startTime = Date.now();
      durationInterval = setInterval(() => {
        const seconds = Math.floor((Date.now() - startTime) / 1000);
        durationDisplay.textContent = `‚è±Ô∏è Duraci√≥n: ${seconds}s`;
      }, 1000);
      recognition.start();
    }

    function stopRecording() {
      isRecording = false;
      recordButton.textContent = "üé§ Grabar Audio";
      clearInterval(durationInterval);
      durationDisplay.textContent = "‚è±Ô∏è Duraci√≥n: 0s";
      recognition.stop();
    }

    recordButton.addEventListener("click", () => {
      isRecording ? stopRecording() : startRecording();
    });
  } else {
    alert("Tu navegador no soporta reconocimiento de voz.");
    recordButton.disabled = true;
  }

  optimizeButton.addEventListener("click", () => {
    const input = inputText.value.trim();
    if (input.length === 0) {
      optimizedPrompt.value = "Por favor, escribe o graba un texto primero.";
      return;
    }
    optimizedPrompt.value = generateOptimizedPrompt(input);
  });

  function optimizePrompt(rawText) {
    const cleaned = rawText.trim();
    if (cleaned.length === 0) return;
    optimizedPrompt.value = generateOptimizedPrompt(cleaned);
  }

  function generateOptimizedPrompt(text) {
    const normalize = (str) =>
      str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase().trim();

const adjectiveExpansions = {
  // Positivos
  "bonita": "visualmente atractiva",
  "hermosa": "visual y est√©ticamente encantadora",
  "preciosa": "de gran belleza visual",
  "moderna": "actual, con un dise√±o innovador",
  "vanguardista": "de estilo adelantado a su tiempo",
  "limpia": "minimalista y sin elementos innecesarios",
  "elegante": "con una est√©tica refinada y sofisticada",
  "dinamica": "interactiva, con elementos visuales en movimiento",
  "atractiva": "que capta la atenci√≥n con un estilo llamativo",
  "simple": "intuitiva y f√°cil de entender",
  "sencilla": "sin complicaciones, clara y funcional",
  "oscura": "en modo oscuro con buen contraste",
  "clara": "con buena iluminaci√≥n y legibilidad",
  "impactante": "que cause una impresi√≥n fuerte y memorable",
  "efectiva": "que cumple su prop√≥sito de forma clara",
  "eficiente": "funciona bien con recursos m√≠nimos",
  "divertida": "con una apariencia alegre y animada",
  "luminosa": "brillante y acogedora",
  "profesional": "adecuada para un entorno formal",
  "seria": "sobria, bien estructurada",
  "accesible": "usable por personas con discapacidades",
  "inspiradora": "que estimula la creatividad o motivaci√≥n",
  "creativa": "original y expresiva",
  "art√≠stica": "con valor est√©tico o expresivo",
  "pulida": "muy bien acabada, con atenci√≥n al detalle",
  "detallada": "cuidadosamente desarrollada",
  "ordenada": "con una disposici√≥n clara y l√≥gica",
  "intuitiva": "f√°cil de usar sin instrucciones",
  "sofisticada": "de dise√±o complejo pero elegante",
  "personalizada": "adaptada a las necesidades del usuario",
  "organica": "natural y fluida en su presentaci√≥n",
  "futurista": "con est√©tica avanzada o tecnol√≥gica",
  "versatil": "adecuada para m√∫ltiples usos o plataformas",
  "compacta": "densa pero bien organizada",
  "coherente": "consistente en estilo y estructura",
  "r√°pida": "responde velozmente sin demoras",
  "robusta": "resistente y bien construida",
  "optimizada": "ajustada para obtener el mejor rendimiento",
  "agradable": "placentera y f√°cil de usar",
  "fluida": "que se mueve o funciona de manera suave",
  "acogedora": "que invita a la comodidad y tranquilidad",
  "modulada": "bien equilibrada en sus elementos",
  "evolutiva": "capaz de adaptarse y mejorar con el tiempo",
  "innovadora": "introduce ideas nuevas y creativas",
  "estable": "funciona sin errores ni ca√≠das",
  "cl√°sica": "con un estilo tradicional y atemporal",
  "vers√°til": "√∫til en diferentes contextos o situaciones",
  "transparente": "clara y f√°cil de entender",
  "f√°cil": "sin dificultad para usar o comprender",
  "concisa": "expresada de forma breve y clara",
  "organizada": "bien estructurada y ordenada",

  // Negativos
  "fea": "con una apariencia descuidada o anticuada",
  "cutre": "de mala calidad o pobremente dise√±ada",
  "horrible": "muy desagradable visualmente",
  "desordenada": "sin estructura clara",
  "caotica": "sin organizaci√≥n ni jerarqu√≠a visual",
  "confusa": "dif√≠cil de entender o navegar",
  "anticuada": "obsoleta y con estilo desactualizado",
  "pasada": "fuera de moda o est√°ndar",
  "aburrida": "mon√≥tona y sin est√≠mulos visuales",
  "plana": "sin profundidad, textura ni variaci√≥n",
  "sobrecargada": "llena de elementos que distraen",
  "recargada": "excesivamente adornada sin prop√≥sito",
  "vaga": "poco definida y sin direcci√≥n",
  "inconsistente": "con estilos o elementos que no combinan entre s√≠",
  "ineficiente": "que no logra cumplir sus objetivos correctamente",
  "lenta": "con bajo rendimiento o tiempos de carga largos",
  "pesada": "con recursos excesivos o mal optimizada",
  "inestable": "propensa a errores o mal funcionamiento",
  "insegura": "que puede comprometer la privacidad o seguridad del usuario",
  "molesta": "que causa incomodidad visual o funcional",
  "incompleta": "que da la sensaci√≥n de estar sin terminar",
  "tosca": "poco refinada o con acabados deficientes",
  "complicada": "dif√≠cil de usar o entender",
  "repetitiva": "con elementos redundantes",
  "pobre": "de calidad baja o poco desarrollada",
  "gris": "sin vida, sin elementos que destaquen",
  "apagada": "con colores o dise√±o sin energ√≠a",
  "exagerada": "con elementos innecesariamente destacados",
  "in√∫til": "sin un prop√≥sito o funcionalidad clara",
  "enga√±osa": "puede inducir a error al usuario",
  "desgastada": "con apariencia envejecida o usada",
  "fr√≠a": "sin calidez o empat√≠a visual",
  "desorganizada": "sin orden ni m√©todo claro",
  "inelegante": "con estilo poco refinado",
  "torpe": "con dise√±o poco cuidado o tosco",
  "desalineada": "sin coherencia visual o estructural",
  "mon√≥tona": "sin variaci√≥n ni inter√©s visual",
  "sobrevalorada": "exageradamente apreciada sin fundamento",
  "irrelevante": "sin importancia o valor en el contexto",
  "desfasada": "no acorde con los tiempos actuales",

  // Neutros o t√©cnicos
  "minimalista": "con el dise√±o m√°s simple y esencial",
  "experimental": "que prueba nuevas ideas o m√©todos",
  "abstracta": "con formas no realistas o simb√≥licas",
  "compleja": "con muchos elementos o niveles de detalle",
  "modular": "compuesta por partes intercambiables",
  "din√°mica": "que cambia o se adapta constantemente",
  "est√°tica": "que permanece sin cambios",
  "interactiva": "que permite la participaci√≥n activa del usuario",
  "adaptativa": "que se ajusta a diferentes dispositivos o condiciones",
  "respetuosa": "que tiene en cuenta normas o est√°ndares",
  "documentada": "con instrucciones o explicaciones claras",
  "escalable": "capaz de crecer sin perder calidad",
  "compatible": "funciona bien con otros sistemas o elementos",
  "personalizable": "que puede modificarse seg√∫n preferencias",
  "comunicativa": "que transmite informaci√≥n claramente",
  "did√°ctica": "con fines educativos o instructivos",
  "anal√≠tica": "orientada al an√°lisis y datos",
  "visual": "que se percibe principalmente por la vista",
  "auditiva": "relacionada con el sentido del o√≠do",
  "t√°ctil": "relacionada con el sentido del tacto",
  "multimedia": "que combina varios tipos de medios",
  "multiling√ºe": "disponible en varios idiomas",
  "segura": "protege contra riesgos o da√±os",
  "privada": "resguarda la informaci√≥n personal",
  "sostenible": "dise√±ada para minimizar impacto ambiental",

  // M√°s adjetivos para describir sensaciones o estilos
  "agradable": "que produce bienestar o placer",
  "ac√∫stica": "relacionada con el sonido o la calidad sonora",
  "acolchonada": "con sensaci√≥n suave o amortiguada",
  "√°gil": "r√°pida y eficiente en sus movimientos o funciones",
  "amplia": "con espacio o alcance grande",
  "apacible": "tranquila y pac√≠fica",
  "armoniosa": "con elementos bien combinados y equilibrados",
  "atrevida": "que arriesga o destaca por su estilo audaz",
  "brillante": "muy luminoso o inteligente",
  "c√°lida": "que transmite calidez o cercan√≠a",
  "cl√°sica": "tradicional y atemporal",
  "compacta": "peque√±a pero bien organizada",
  "confortable": "que ofrece comodidad",
  "cristalina": "clara y transparente",
  "curvada": "con formas redondeadas",
  "delicada": "fina y sutil",
  "efusiva": "que expresa emociones intensas",
  "el√©ctrica": "con energ√≠a o dinamismo",
  "en√©rgica": "con fuerza y vitalidad",
  "esbelta": "delgada y elegante",
  "et√©rea": "ligera y casi intangible",
  "ex√≥tica": "rara y diferente a lo com√∫n",
  "expl√≠cita": "clara y sin ambig√ºedades",
  "fant√°stica": "imaginativa y sorprendente",
  "fina": "de calidad superior o delicada",
  "flexible": "que se adapta f√°cilmente",
  "genuina": "aut√©ntica y sincera",
  "glamorosa": "llamativa y elegante",
  "honesta": "clara y sin enga√±os",
  "intensa": "fuerte y profunda",
  "juvenil": "con aire joven o fresco",
  "kilom√©trica": "muy larga o extensa",
  "limpia": "sin impurezas o desorden",
  "m√°gica": "que produce asombro o fascinaci√≥n",
  "n√≠tida": "clara y definida",
  "opaca": "sin brillo ni transparencia",
  "profunda": "con mucho significado o profundidad",
  "quieta": "sin movimiento",
  "radiante": "que brilla intensamente",
  "r√°pida": "que sucede en poco tiempo",
  "relajada": "tranquila y sin estr√©s",
  "sabia": "con conocimiento o experiencia",
  "segura": "libre de peligro",
  "sensible": "receptiva a est√≠mulos",
  "silenciosa": "sin ruido",
  "suave": "agradable al tacto o al o√≠do",
  "transparente": "clara y sin ocultaciones",
  "uniforme": "igual en toda su extensi√≥n",
  "vibrante": "llena de vida o energ√≠a",
  "zonal": "relacionada con una zona o √°rea espec√≠fica",
  // Positivos
"brillante": "con mucho brillo o inteligencia",
"inteligente": "que demuestra buen entendimiento",
"amigable": "que inspira confianza y cordialidad",
"r√°pido": "que act√∫a con velocidad",
"seguro": "confiable y estable",
"flexible": "adaptable a diferentes situaciones",
"fresco": "nuevo, original y atractivo",
"s√≥lido": "firme y resistente",
"valiente": "con coraje y determinaci√≥n",
"simp√°tico": "agradable y f√°cil de tratar",
"generoso": "que da sin esperar nada a cambio",
"ordenado": "organizado y limpio",
"eficaz": "que logra el resultado esperado",
"tranquilo": "calmado y sereno",
"aut√©ntico": "genuino y verdadero",
"optimista": "con una visi√≥n positiva",
"exitoso": "que logra metas y triunfos",
"amable": "que muestra bondad y cortes√≠a",
"carism√°tico": "que atrae y cautiva a los dem√°s",
"valioso": "de gran utilidad o importancia",
"bravo": "valiente y decidido",
"encantador": "que gusta y atrae f√°cilmente",
"fiel": "leal y constante",
"agradable": "placentero y simp√°tico",
"meticuloso": "muy detallista y cuidadoso",
"persistente": "que no se rinde f√°cilmente",
"responsable": "cumple con sus obligaciones",
"sincero": "honesto y genuino",
"solidario": "que apoya a los dem√°s",
"creativo": "con capacidad para inventar y crear",
"detallista": "que presta atenci√≥n a los detalles",
"entusiasta": "que muestra gran inter√©s y energ√≠a",
"generoso": "que comparte y da con facilidad",
"honesto": "que act√∫a con verdad y rectitud",
"humilde": "sin arrogancia ni prepotencia",
"leal": "fiel y comprometido",
"modesto": "sin pretensiones exageradas",
"noble": "de elevada calidad moral",
"ordenado": "organizado y sistem√°tico",
"paciente": "capaz de soportar sin quejarse",
"prudente": "que act√∫a con precauci√≥n",
"respetuoso": "que muestra respeto a los dem√°s",
"sabio": "con conocimiento y experiencia",
"sereno": "calmado y sin perturbaciones",
"valeroso": "que muestra valor y coraje",
"vers√°til": "adaptable a diversas situaciones",
"vigorizante": "que da energ√≠a y fuerza",
"vivo": "inteligente y perceptivo",
"tranquilo": "calmado y sosegado",
"intuitivo": "que comprende sin necesidad de explicaciones",
"organizado": "que mantiene todo en orden",
"eficiente": "que consigue resultados con poco esfuerzo",

// Negativos
"torpe": "con poca habilidad o destreza",
"lento": "con velocidad baja o pausada",
"feo": "de apariencia desagradable",
"vac√≠o": "sin contenido o sustancia",
"fr√≠o": "sin calidez o empat√≠a",
"d√©bil": "sin fuerza o vigor",
"r√≠gido": "inflexible y estricto",
"descuidado": "sin atenci√≥n o esmero",
"peligroso": "que puede causar da√±o",
"vago": "poco claro o definido",
"ins√≠pido": "sin sabor o inter√©s",
"grosero": "con falta de educaci√≥n o delicadeza",
"irritante": "que causa molestia",
"inestable": "que cambia con facilidad o falla",
"desconfiado": "que no conf√≠a f√°cilmente",
"pesimista": "con una visi√≥n negativa",
"inmaduro": "que no est√° desarrollado o es infantil",
"imprudente": "que act√∫a sin precauci√≥n",
"arrogante": "que muestra soberbia y superioridad",
"perezoso": "que evita el trabajo o esfuerzo",
"antip√°tico": "desagradable y poco amigable",
"inseguro": "con falta de confianza",
"desordenado": "sin organizaci√≥n ni limpieza",
"desleal": "que no es fiel o confiable",
"vacilante": "que duda o no se decide",
"insensible": "sin capacidad para sentir empat√≠a",
"t√≥xico": "que genera efectos negativos o da√±inos",
"desagradable": "que causa molestia o rechazo",
"fr√°gil": "d√©bil y f√°cil de romper",
"pesado": "molesto o dif√≠cil de soportar",
"confuso": "dif√≠cil de entender o explicar",
"in√∫til": "sin utilidad o prop√≥sito",
"ignorante": "falto de conocimiento",
"infeliz": "sin felicidad o alegr√≠a",
"irresponsable": "que no cumple con sus deberes",
"desleal": "que traiciona la confianza",
"insatisfecho": "que no est√° contento o conforme",
"desesperado": "sin esperanza o con ansiedad extrema",
"inhumano": "carente de compasi√≥n",
"desordenado": "sin sistema ni estructura",
"indeciso": "que no puede decidir f√°cilmente",
"ineficaz": "que no consigue resultados",
"insociable": "que evita la compa√±√≠a de otros",
"impaciente": "que no puede esperar con calma",
"impreciso": "que carece de exactitud",
"injusto": "que no act√∫a con equidad",
"inh√°bil": "sin destreza o habilidad",
"indiferente": "que no muestra inter√©s o preocupaci√≥n",
"descontento": "que no est√° satisfecho",
"aburrido": "sin inter√©s ni emoci√≥n",
"molesto": "que causa incomodidad o irritaci√≥n",
"agotado": "muy cansado o sin energ√≠a",
"desorganizado": "que no tiene orden ni sistema",
};

function stripRedundantKeywords(raw, keywords) {
  let output = raw;
  for (const word of keywords) {
    const regex = new RegExp(`\\b${word}\\b`, 'gi');
    output = output.replace(regex, '');
  }
  return output.replace(/\s{2,}/g, ' ').trim();
}

function cleanRaw(raw) {
  return raw
    // saludos y cortes√≠as
    .replace(/\b(hola|saludos|buenas\s*(tardes|noches|d√≠as)?|hey|qu√© tal|c√≥mo\s*(est√°s|te va)|espero que est√©s bien|buen d√≠a|buenas)\b/gi, "")
    // expresiones de cortes√≠a o agradecimiento
    .replace(/\b(por favor|porfa|favor|gracias|muchas gracias|vale|ok|okey|venga|genial|perfecto|dale|listo|claro|bueno|eh|mmm|aja|aj√°|ehh|ser√≠as tan amable)\b/gi, "")
    // muletillas y expresiones vagas
    .replace(/\b(en general|b√°sicamente|pr√°cticamente|m√°s o menos|algo as√≠|m√°s bien|sobre todo|en realidad|a veces|a menudo|de vez en cuando|usualmente|normalmente|frecuentemente|eventualmente|finalmente|generalmente|probablemente|quiz√°s|quiz√°|tal vez|posiblemente|seguramente|nunca|siempre|casi|aproximadamente|aprox|relativamente|medianamente|poco|mucho|demasiado|un poco|un tanto)\b/gi, "")
    // expresiones comparativas o coloquiales
    .replace(/\b(como si fuera|parecido a|similar a|en plan|tipo de|tipo|a lo mejor|algo as√≠|m√°s que nada|m√°s que|menos que|lo t√≠pico|lo normal|lo com√∫n|lo usual|lo de siempre)\b/gi, "")
    // conjunciones y conectores
    .replace(/\b(y|o|pero|aunque|adem√°s|tambi√©n|mientras|sin embargo|porque|ya que|pues|entonces|luego|despu√©s|antes|cuando|donde|ya|s√≠|no|si|as√≠ que|por lo tanto|por consiguiente|por eso|de hecho|en cambio|por otro lado|entretanto|aun as√≠)\b/gi, "")
    // art√≠culos, pronombres y determinantes
    .replace(/\b(el|la|los|las|un|una|unos|unas|esto|eso|aquello|ese|esa|aquel|aquella|mi|mis|tu|tus|su|sus|me|te|nos|vos|ellos|ellas|yo|t√∫|usted|ustedes|s√≠ mismo|uno mismo|algo|nada|todo|cada|cualquiera|ninguno|alg√∫n|alguna|ning√∫n|ninguna)\b/gi, "")
    // verbos auxiliares comunes, imperativos y comandos gen√©ricos
    .replace(/\b(ser|estar|haber|tener|ir|venir|ver|decir|dar|poder|deber|saber|querer|pensar|parecer|sentir|pasar|quedar|llevar|dejar|seguir|encontrar|leer|funcionar|servir|entender|comprender|existir|ocurrir|suceder|haz|hazme|hazlo|dame|dame|pon|ponme|pasa|p√°same|mira|m√≠rala|tr√°eme|trae|coge|c√≥gelo|toma|t√≥malo|di|d√≠melo|graba|abre|ci√©rralo|dibuja|escribe|crea|genera|programa|redacta|describe)\b/gi, "")
    // URLs y correos
    .replace(/https?:\/\/[^\s]+/gi, "")
    .replace(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/gi, "")
    // n√∫meros
    .replace(/\b\d+(\.\d+)?\b/g, "")
    // s√≠mbolos y caracteres no alfab√©ticos
    .replace(/[^a-zA-Z√°√©√≠√≥√∫√±√º√Å√â√ç√ì√ö√ë√ú\s]/g, "")
    // palabras repetidas consecutivas
    .replace(/\b(\w+)\s+\1\b/gi, "$1")
    // m√∫ltiples espacios a uno solo
    .replace(/\s{2,}/g, " ")
    .trim();
}

function expandAdjectives(txt) {
  return txt.split(/\s+/).map(word => {
    const norm = normalize(word);
    return adjectiveExpansions[norm] || word;
  }).join(" ");
}

const rawCleaned = cleanRaw(text);
const normalizedText = normalize(rawCleaned);

const categories = [
  {
    keywords: ["web", "html", "sitio", "pagina", "p√°gina", "formulario", "frontend", "maqueta", "maquetar", "dise√±a", "dise√±ame"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["pagina", "p√°gina", "web", "html", "sitio", "formulario", "frontend"]);
      const cleaned = expandAdjectives(stripped);
      return `üíª *Prompt para desarrollo web:*\n\nDise√±a una p√°gina web ${cleaned}. Aseg√∫rate de que sea responsive, accesible y bien estructurada. Utiliza HTML, CSS y JavaScript.`;
    }
  },
  {
    keywords: ["imagen", "visual", "dibujo", "arte", "estilo", "ilustracion", "ilustraci√≥n", "foto", "paisaje", "retrata", "dibuja", "dibujame", "creame", "crea", "il√∫strame"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["imagen", "dibujo", "ilustracion", "foto", "paisaje"]);
      const cleaned = expandAdjectives(stripped);
      return `üñºÔ∏è *Prompt para generador de im√°genes:*\n\nGenera una imagen basada en esta descripci√≥n: ${cleaned}. Cuida iluminaci√≥n, proporciones, composici√≥n y estilo art√≠stico.`;
    }
  },
  {
    keywords: ["historia", "cuento", "relato", "ficcion", "ficci√≥n", "personajes", "aventura", "inventa", "narrame", "cuentame", "escribeme"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["historia", "cuento", "relato", "ficcion", "ficci√≥n"]);
      const cleaned = expandAdjectives(stripped);
      return `üìö *Prompt para historia creativa:*\n\nEscribe una historia original basada en esta idea: ${cleaned}. Incluye personajes interesantes, narrativa coherente y un desenlace s√≥lido.`;
    }
  },
  {
    keywords: ["resumen", "resumir", "sintesis", "extracto", "resumas", "res√∫meme", "resume", "res√∫melo", "res√∫mela", "res√∫manlo"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["resumen", "resumir", "sintesis", "extracto", "resumas","resumeme"]);
      const cleaned = expandAdjectives(stripped);
      return `üìã *Prompt para resumen de texto:*\n\nResume el siguiente contenido de forma clara y precisa: ${cleaned}. Conserva los puntos clave y evita repeticiones innecesarias.`;
    }
  },
  {
    keywords: ["email", "correo", "mensaje", "formal", "respuesta", "responder", "respondas", "responde", "responderme", "respuestame", "redacta", "redactame"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["email", "correo", "mensaje", "respuesta", "responder"]);
      const cleaned = expandAdjectives(stripped);
      return `üìß *Prompt para redacci√≥n de email:*\n\nRedacta un correo formal con esta intenci√≥n: ${cleaned}. Usa un tono respetuoso, lenguaje profesional y estructura adecuada.`;
    }
  },
  {
    keywords: ["codigo", "script", "programa", "funcion", "algoritmo", "automatica", "automatizar", "programar", "codificame", "escribeme", "hazme un script", "crea c√≥digo", "generame codigo"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["codigo", "script", "programa", "funcion", "algoritmo"]);
      const cleaned = expandAdjectives(stripped);
      return `üß† *Prompt para desarrollo de c√≥digo:*\n\nCrea un script o programa que realice lo siguiente: ${cleaned}. Aseg√∫rate de usar buenas pr√°cticas de programaci√≥n y explicar cada secci√≥n del c√≥digo.`;
    }
  },
  {
    keywords: ["poema", "poes√≠a", "verso", "rima", "poeta", "hazme un poema", "escribeme un verso", "creame una poesia"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["poema", "poes√≠a", "verso"]);
      const cleaned = expandAdjectives(stripped);
      return `üé≠ *Prompt para poes√≠a:*\n\nEscribe un poema sobre: ${cleaned}. Utiliza un estilo evocador, buena m√©trica y tono emocional.`;
    }
  },
  {
    keywords: ["linkedin", "perfil", "publicaci√≥n", "trabajo", "infojobs", "post", "posteame", "hazme un post"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["linkedin", "perfil", "publicaci√≥n", "post"]);
      const cleaned = expandAdjectives(stripped);
      return `üíº *Prompt para LinkedIn:*\n\nRedacta una publicaci√≥n profesional para LinkedIn basada en: ${cleaned}. Usa un tono formal y motivador.`;
    }
  },
  {
    keywords: ["cv", "curriculum", "hoja de vida", "curr√≠culum", "hazme el cv", "redactame un cv"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["cv", "curriculum", "hoja de vida", "curr√≠culum"]);
      const cleaned = expandAdjectives(stripped);
      return `üìÑ *Prompt para CV:*\n\nGenera una secci√≥n del curr√≠culum que describa: ${cleaned}. Utiliza un tono profesional y enfocado en logros.`;
    }
  },
  {
    keywords: ["pitch", "propuesta", "cliente", "inversionista", "hazme una propuesta", "presentame un pitch"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["pitch", "propuesta", "cliente", "inversionista"]);
      const cleaned = expandAdjectives(stripped);
      return `üì¢ *Prompt para propuesta/pitch:*\n\nRedacta una propuesta o pitch convincente sobre: ${cleaned}. Incluye problema, soluci√≥n y beneficios.`;
    }
  },
  {
    keywords: ["viaje", "itinerario", "destino", "turismo", "hazme un plan de viaje", "crea un itinerario"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["viaje", "itinerario", "destino", "turismo"]);
      const cleaned = expandAdjectives(stripped);
      return `‚úàÔ∏è *Prompt para plan de viaje:*\n\nCrea un itinerario tur√≠stico para: ${cleaned}. Incluye lugares clave, horarios sugeridos y recomendaciones.`;
    }
  },
  {
    keywords: ["dashboard", "kpi", "metricas", "informe", "reportame", "visualizame datos", "hazme un dashboard"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["dashboard", "kpi", "metricas", "informe"]);
      const cleaned = expandAdjectives(stripped);
      return `üìä *Prompt para dashboard:*\n\nDise√±a un dashboard con m√©tricas clave para: ${cleaned}. Aseg√∫rate de representar datos relevantes de forma visual.`;
    }
  },
  {
    keywords: ["latex", "ecuacion", "ecuaci√≥n", "formula", "f√≥rmula", "escribeme en latex"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["latex", "ecuacion", "ecuaci√≥n", "formula", "f√≥rmula"]);
      const cleaned = expandAdjectives(stripped);
      return `üìê *Prompt LaTeX:*\n\nEscribe la f√≥rmula en LaTeX que representa: ${cleaned}.`;
    }
  },
  {
    keywords: ["yaml", "configuracion", "config", "archivo", "genera yaml", "hazme un archivo de configuracion"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["yaml", "configuracion", "config", "archivo"]);
      const cleaned = expandAdjectives(stripped);
      return `üõ†Ô∏è *Prompt para YAML/config:*\n\nConvierte lo siguiente en una configuraci√≥n YAML bien estructurada: ${cleaned}.`;
    }
  },
  {
    keywords: ["an√°lisis", "analisis", "estudio", "investigaci√≥n", "examina", "evaluaci√≥n", "revisi√≥n", "reporte", "examinar", "analizame", "hazme un estudio"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["an√°lisis", "analisis", "estudio", "investigaci√≥n", "evaluaci√≥n", "revisi√≥n", "reporte"]);
      const cleaned = expandAdjectives(stripped).replace(/^de(l)?\s+/i, "");
      return `üîç *Prompt para an√°lisis o estudio:*\n\nRealiza un an√°lisis detallado sobre: ${cleaned}. Incluye observaciones relevantes, posibles conclusiones y, si es pertinente, gr√°ficos o comparativas.`;
    }
  },
  {
    keywords: ["texto", "desarrolla", "explica", "describe", "escribe", "redacta", "parrafo", "contenido", "tema", "hazme", "hazme un texto", "elabora", "explicame", "describeme"],
    prompt: raw => {
      const stripped = stripRedundantKeywords(raw, ["texto", "desarrolla", "explica", "describe", "escribe", "redacta", "parrafo", "contenido", "tema", "hazme", "elabora", "sobre", "explicame"]);
      const cleaned = expandAdjectives(stripped);
      return `‚úçÔ∏è *Prompt para desarrollo de texto:*\n\nEscribe un texto claro y detallado sobre: ${cleaned}. Aseg√∫rate de que sea coherente, bien estructurado y relevante al tema.`;
    }
  }
];

// Selecci√≥n de categor√≠a
for (const category of categories) {
  if (category.keywords.some(keyword => normalizedText.includes(normalize(keyword)))) {
    return category.prompt(rawCleaned);
  }
}

// Fallback
return `ü§î *No se ha detectado un tema espec√≠fico:*\n\nAseg√∫rate de que no hay faltas de ortograf√≠a e intenta reformular la idea usando palabras clave m√°s claras o espec√≠ficas.\nPor ejemplo: "crear una p√°gina web de recetas", "resumir un art√≠culo", "generar una imagen de un drag√≥n en el espacio", etc.`;
  }
</script>
</body>
</html>
